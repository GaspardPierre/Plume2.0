BEGIN;

DROP TABLE IF EXISTS "utilisateur",
"oeuvre",
"categorie",
"a",
"note",
"commentaire";


CREATE TABLE "utilisateur" (
"id" INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
"pseudo" TEXT NOT NULL,
"email" TEXT NOT NULL,
"password" TEXT NOT NULL,
"role" TEXT NOT NULL
);

CREATE TABLE "oeuvre" (
"id" INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
"content" TEXT NOT NULL,
"auteur" TEXT NOT NULL,
"titre" VARCHAR NOT NULL,
"utilisateur_id" INT NOT NULL REFERENCES "utilisateur"("id"),
"create_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
"update_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE "categorie" (
"id" INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
"genre" TEXT NOT NULL,
"create_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
"update_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "a" (
"id" INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
"oeuvre_id" INT NOT NULL REFERENCES "oeuvre"("id"),
"categorie_id" INT NOT NULL REFERENCES "categorie"("id")

);

CREATE TABLE "note" (
"id" INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
"moyenne" INT,
"utilisateur_id" INT NOT NULL REFERENCES "utilisateur"("id"),
"oeuvre_id" INT NOT NULL REFERENCES "oeuvre"("id"),
"create_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
"update_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "commentaire" (
"id" INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
"content" TEXT NOT NULL,
"utilisateur_id" INT NOT NULL REFERENCES "utilisateur"("id"),
"oeuvre_id" INT NOT NULL REFERENCES "oeuvre"("id")

);





COMMIT;